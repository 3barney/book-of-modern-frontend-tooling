<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="description" content=""><link href="http://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet" type="text/css"><link rel="stylesheet" href="http://getbootstrap.com/dist/css/bootstrap.min.css"><script src="http://code.jquery.com/jquery-2.1.0.min.js"></script><link rel="stylesheet" href="/assets/css/style.css"></head><body><div id="container" class="container-fluid"><div class="row"><div id="sidebar" class="sidebar col-md-3"><div><br><ul>
<li><p><a href="/introduction.html">Introduction</a></p>
</li>
<li><p><a href="">Build Systems</a></p>
<ul>
<li><a href="/build-systems/modern-tools-vs-shell-scripts.html">Modern tools vs shell scripts</a></li>
<li><p><a href="">Grunt</a></p>
<ul>
<li><a href="/build-systems/grunt/introduction.html">Introduction</a></li>
<li><a href="/build-systems/grunt/getting-started.html">Getting started</a></li>
<li><a href="/build-systems/grunt/linter.html">Linting code</a></li>
<li><a href="/build-systems/grunt/sass.html">Integrating a CSS preprocessor</a></li>
<li><a href="/build-systems/grunt/troubleshooting.html">Troubleshooting</a></li>
<li><a href="/build-systems/grunt/references.html">References</a></li>
</ul>
</li>
<li><p><a href="">Brunch</a> </p>
<ul>
<li><a href="/build-systems/brunch/introduction.html">Introduction</a></li>
<li><a href="/build-systems/brunch/getting-started.html">Getting started</a></li>
<li><a href="/build-systems/brunch/using-brunch.html">Using Brunch</a></li>
<li><a href="/build-systems/brunch/troubleshooting.html">Troubleshooting</a></li>
<li><a href="/build-systems/brunch/references.html">References</a></li>
</ul>
</li>
<li><p><a href="">Gulp</a></p>
<ul>
<li><a href="/build-systems/gulp/introduction.html">Introduction</a></li>
<li><a href="/build-systems/gulp/getting-started.html">Getting started</a></li>
<li><a href="/build-systems/gulp/writing-tasks.html">Writing tasks</a></li>
<li><a href="/build-systems/gulp/troubleshooting.html">Troubleshooting</a></li>
<li><a href="/build-systems/gulp/references.html">References</a></li>
</ul>
</li>
</ul>
</li>
<li><p><a href="">Dependency management</a></p>
<ul>
<li><p><a href="">Bower</a></p>
<ul>
<li><a href="/dependency-management/bower/introduction.html">Introduction</a></li>
<li><a href="/dependency-management/bower/getting-started.html">Getting started</a></li>
<li><a href="/dependency-management/bower/bower-topic-1.html">Topic</a></li>
<li><a href="/dependency-management/bower/troubleshooting.html">Troubleshooting</a></li>
<li><a href="/dependency-management/bower/references.html">References</a></li>
</ul>
</li>
<li><p><a href="">Component JS</a></p>
<ul>
<li><a href="/dependency-management/componentjs/introduction.html">Introduction</a></li>
<li><a href="/dependency-management/componentjs/getting-started.html">Getting started</a></li>
<li><a href="/dependency-management/componentjs/componentjs-topic-1.html">Topic</a></li>
<li><a href="/dependency-management/componentjs/troubleshooting.html">Troubleshooting</a></li>
<li><a href="/dependency-management/componentjs/references.html">References</a></li>
</ul>
</li>
<li><p><a href="">NPM browserify</a></p>
<ul>
<li><a href="/dependency-management/npm-browserify/introduction.html">Introduction</a></li>
<li><a href="/dependency-management/npm-browserify/getting-started.html">Getting started</a></li>
<li><a href="/dependency-management/npm-browserify/npm-browserify-topic-1.html">Topic</a></li>
<li><a href="/dependency-management/npm-browserify/troubleshooting.html">Troubleshooting</a></li>
<li><a href="/dependency-management/npm-browserify/references.html">References</a></li>
</ul>
</li>
</ul>
</li>
<li><p><a href="">Scaffolding</a></p>
<ul>
<li><p><a href="">Loom</a></p>
<ul>
<li><a href="/scaffolding/loom/introduction.html">Introduction</a></li>
<li><a href="/scaffolding/loom/getting-started.html">Getting started</a></li>
<li><a href="/scaffolding/loom/loom-topic-1.html">Topic</a></li>
<li><a href="/scaffolding/loom/troubleshooting.html">Troubleshooting</a></li>
<li><a href="/scaffolding/loom/references.html">References</a></li>
</ul>
</li>
<li><p><a href="">Yeoman</a></p>
<ul>
<li><a href="/scaffolding/yeoman/introduction.html">Introduction</a></li>
<li><a href="/scaffolding/yeoman/getting-started.html">Getting started</a></li>
<li><a href="/scaffolding/yeoman/yeoman-topic-1.html">Topic</a></li>
<li><a href="/scaffolding/yeoman/troubleshooting.html">Troubleshooting</a></li>
<li><a href="/scaffolding/yeoman/references.html">References</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div></div><div id="content" class="content col-md-9"><h1 id="integrating-a-css-preprocessor">Integrating a CSS preprocessor</h1>
<p><strong>CSS preprocessors</strong> can compile CSS stylesheets from other (more powerful) styling languages. These new languages have features like variables, functions, mixins (to re-use code), etc. and they will change for the better the way you approach class naming an use.</p>
<p>The most popular CSS preprocessors are <a href="http://sass-lang.com/">Sass</a> and <a href="http://lesscss.org/">Less</a>, and since both of them do their job really well, it&#39;s up to you to decide which one you like the most. This chapter will cover Sass examples, but the way to integrate Less in Grunt is similar.</p>
<p>Sass was originally a Ruby gem, although there are versions for other languages, like C or Node.js. Once installed[^install], you can compile a Sass stylesheet with:</p>
<pre><code class="lang-bash">sass main.sass main.css
</code></pre>
<p>[^install]: <code>gem install sass</code></p>
<p>The good news is that you can integrate the compiling part into Grunt, so it&#39;s part of your regular workflow.</p>
<h2 id="install-the-plugin">Install the plugin</h2>
<p>The recommended plugin for Sass is <code>grunt-contrib-sass</code>, and you can install it like any other Grunt plugin:</p>
<pre><code class="lang-bash">npm --save-dev grunt-contrib-sass
</code></pre>
<p>Don&#39;t forget to load the task in your <code>Gruntfile.js</code>:</p>
<pre><code class="lang-js">module.exports = function (grunt) {
  grunt.loadNpmTasks(&#39;grunt-contrib-sass&#39;);

  grunt.initConfig({
    sass: {} // config goes here
  });
};
</code></pre>
<h2 id="task-targets">Task targets</h2>
<p>The plugin we are using is a bit special, since it <em>requires</em> you to create <strong>targets</strong> (or configurations) for it.</p>
<p>A target is just a name associated to a task configuration. Let&#39;s say that you want to have a Sass configuration for development (<code>dev</code>) different from the configuration for production (<code>prod</code>)[^names]. Once you define these two targets, you can run a task target with:</p>
<pre><code>grunt sass:dev
</code></pre><p>[^names]: Note that these are arbitrary names.</p>
<p>When a task has multiple targets, if you omit the target name, then <em>all targets</em> will be executed. We will see examples of this use in other plugins.</p>
<p>The way you define targets, is by adding them as a key in the configuration object. For instance:</p>
<pre><code class="lang-js">grunt.initConfig({
  sass: {
    dev: {}, // config for target &#39;dev&#39; here
    prod: {}
  }
});
</code></pre>
<h2 id="source-destination-file-matching">Source-destination file-matching</h2>
<p>The <code>sass</code> task is different from the <code>jshint</code> task in the way the accept files. With the linter, you just needed to supply input files; but <code>sass</code> requires both <em>input</em> (source) and <em>output</em> (destination) files.</p>
<p>The easiest — but less powerful — way to supply these source-destination files is by using a <em>files Object</em>. See this example:</p>
<pre><code class="lang-js">sass: {
  dev: {
    files: {&#39;styles/screen.css&#39;: [&#39;sass/common.sass&#39;, &#39;sass/main.sass&#39;]}
  }
}
</code></pre>
<p>There, the destination is <code>screen.css</code>, whereas the source is a list of files (<code>common.sass</code> and <code>main.sass</code>).</p>
<p>If you have only a few sass files, this mapping is probably good enough. However, there is a way to have a <strong>dynamic mapping</strong>, in which the destination files are unknown. Here is an example:</p>
<pre><code class="lang-js">sass: {
  dev: {
    files: [{
      cwd: &#39;sass&#39;,
      dest: &#39;styles&#39;,
      src: [&#39;*.{sass.scss}&#39;],
      ext: &#39;.css&#39;,
      expand: true
    }]
  }   
}
</code></pre>
<p>The key here is the <strong><code>expand</code> flag</strong>, since setting it to <code>true</code> enables dynamic mapping. The task will get the <code>src</code> files, located under the <code>cwd</code> directory, and copy them into <code>dest</code> with the same name but <code>ext</code> extension. So, if we have two files <code>sass/main.sass</code> and <code>sass/common.sass</code> we would have them compiled into <code>styles/main.css</code> and <code>styles/common.css</code>.</p>
<p>Also, note that we have <strong>an array of Objects</strong>, so you can specify more than one mapping rule set.</p>
<p>For more information about source-destination file mapping (you can do cool things, like filtering out files or custom renaming), read <a href="http://gruntjs.com/configuring-tasks#files">Grunt&#39;s documentation</a>.</p>
<h2 id="configuration-options">Configuration options</h2>
<p>The <strong>options</strong> that you have available mimic what you can pass to Sass in the command line[^sass-docs]: the output style, whether to include or not line numbers, where is located the cache, etc.</p>
<p>Here is a common configuration for development:</p>
<pre><code class="lang-js">sass: {
  dev: {
    options: {
      style: &#39;expanded&#39;, // output style
      lineNumbers: true,
      sourcemap: true // generate Source Maps for the browser
    },
    files: {&#39;css/main.css&#39;: [&#39;sass/*.{sass,scss}&#39;]}
  }
}
</code></pre>
<p>[^sass-docs]: See <a href="https://github.com/gruntjs/grunt-contrib-sass">the plugin documentation</a> for a full list.</p>
<h2 id="avoid-repetition-with-grunt-s-template-engine">Avoid repetition with Grunt&#39;s template engine</h2>
<p>It is very likely that you will need to process <strong>the same</strong> Sass files in both your development and distribution targets. You could repeat the <code>files</code> configuration like this:</p>
<pre><code class="lang-js">sass: {
  dev: {
    options: {style: &#39;expanded&#39;},
    files: {&#39;css/main.css&#39;: [&#39;sass/*.{sass,scss}&#39;]}
  },
  prod: {
    options: {style: &#39;compressed&#39;},
    files: {&#39;css/main.css&#39;: [&#39;sass/*.{sass,scss}&#39;]}
  }
}
</code></pre>
<p>A DRY[^dry] approach would be to take advantage of Grunt&#39;s <strong>template engine</strong>[^lo-dash]. Long story short: everything you include between <code>&lt;%=</code> and <code>%&gt;</code> in a string, will be processed as a template and — here&#39;s the cool part — you can use your tasks configuration properties as template variables, for instance: <code>&lt;%= jshint.files %&gt;</code>. </p>
<p>[^lo-dash]: Powered by <a href="http://lodash.com/docs#template">Lo-Dash</a></p>
<p>This is an improved version of the previous example:</p>
<pre><code class="lang-js">sass: {
  dev: {
    options: {style: &#39;expanded&#39;},
    files: {&#39;css/main.css&#39;: [&#39;sass/*.{sass,scss}&#39;]}
  },
  prod: {
    options: {style: &#39;compressed&#39;},
    files: &#39;&lt;%= sass.dev.files %&gt;&#39;
  }
}
</code></pre>
<p>[^dry]: &quot;Don&#39;t Repeat Yourself&quot;</p>
</div></div><hr><div id="footer" class="center">Copyright 2014</div></div><script>var _gaq = _gaq || [];
_gaq.push(['_setAccount', google_uid]);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></body></html>